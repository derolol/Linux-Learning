# Week2课堂笔记

## 目录的构成

### 1. 作用

将由字符串组成的路径转化为文件的物理地址

---

### 2. 基本构成

文件 = 元数据（控制）+用户数据

元数据集中存放在目录文件

> ls -l 目录文件的内容

|文件的类型|读写执行权限控制|用户名|组名|链接数|文件大小| 时间
| :-: | :-: | :-: | :-: | :-: | :-: | :-: |
|- 普通磁盘文件|文件主人 同组用户 其他人||一个人也可以成组|快捷方式|||
|d 目录文件|rw-rw-r--||||||
|c 字符设备文件|110110100||||||
|b 快设备文件|664||||||
|p 管道文件|||||||
|l 链接文件||||||||

---

### 3. 目录文件

+ 需要的基本内容

|Name|Attribute|Size|Time|Adress|Table
|-|-|-|--|--|--|
||||||||

+ 文件存储方式
  + 连续
  + 链式
  + 索引

+ 实际解决方法：

① 基本目录项： PATH->INDEX NUMBER

|file name|i-node号|
| :-: | :-: |
||||

  ② 索引节点(INDEX NODE)：i.权限控制 ii.找出对应地址表

|i-node号|attribute|size|time|index-table|
|-|-|-|-|-|-|
|||||||

---

### 4. 相关操作命令

+ **chmod** 设置文件权限

  + `chmod 777 文件名`

    文件的权限更改为 rwxrwxrwx

  + 如脚本文件可执行，则文件名显示为绿色

+ **time** 运行并计算程序运行的时间

  `time 文件名`

+ **file** 查看文件类型

  `file 文件名`

+ **strace**

  + ELF文件

    + shared object 库文件
    + relocatable 可重定位
    + executable 可执行
    + core dump 核心转储文件

  + 用户执行指令

    + `用户名@主机`

      `rld@localhost# ./1-2`

    + 过程

      shell -> 派生子进程 execve ./1-2 -> init mmap（上下文转换） （System Call） -> main函数 返回 exit code 给 shell

  + 作用      

    监控用户空间进程和内核的交互，如系统调用、信号传递、进程状态变更等

    `strace echo hello 2>&1 >/dev/null|group write`

> 返回值 0 - 255

|错误代码|错误类型|
|-|-|
|0|成功|
|1-100|固定错误类型
|101+|用户自定义|

+ **gdb** 调试程序

  + **(gdb) list** 将程序打印出来

  + **(gdb) break 行号** 设置断点

  + **(gdb) run** 运行

  + **(gdb) continue** 继续运行 简写为 `c`

  + **(gdb) print**  打印变量的值 简写为 `p`

  + **(gdb) help** 帮助

  + **(gdb) quit** 退出

+ **strip 文件名** 删除调试信息

+ **gcc 文件.c -o 文件 -g** 编译并增加调试信息

+ **pgrep -l 命令** 查找运行该命令的所有进程

+ **ps -ef** 查看全格式的全部进程

+ **kill** 结束进程

+ **lsof -p 进程号** 列出打开的文件

+ **ls -l /proc/进程号/fd** 查看进程描述符

---

### 5. 例子 `sleep 300 | sleep 400&`

+ `'|'` 管道 进程间通信

+ 文件描述符

|编号|对应|描述|
|:-:|:-:|:-:|
|0|stdin|标准输入|
|1|stdout|标准输出|
|2|stderr|表传错误输出|

+ `'&'` 后台工作
